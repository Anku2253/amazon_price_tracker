{% extends "base.html" %} {% block title %}Server Error - Amazon Price Tracker{%
endblock %} {% block content %}
<div class="container-fluid">
  <div class="row justify-content-center">
    <div class="col-lg-8 col-md-10">
      <div class="error-page text-center">
        <!-- Error Icon -->
        <div class="error-icon mb-4">
          <svg
            width="120"
            height="120"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
            class="text-danger"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
        </div>

        <!-- Error Code -->
        <h1 class="error-code display-1 fw-bold text-danger mb-3">500</h1>

        <!-- Error Title -->
        <h2 class="error-title h3 text-secondary mb-4">
          Internal Server Error
        </h2>

        <!-- Error Message -->
        <div class="error-message mb-5">
          <p class="lead text-muted mb-3">
            Something went wrong on our end. Our server encountered an
            unexpected error and couldn't complete your request.
          </p>
          <p class="text-muted">
            Don't worry - it's not your fault! Our team has been automatically
            notified and we're working to fix this issue.
          </p>
        </div>

        <!-- Status Information -->
        <div class="alert alert-warning mb-4" role="alert">
          <div class="d-flex align-items-center">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              class="me-3 flex-shrink-0"
            >
              <path
                d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"
              ></path>
              <line x1="12" y1="9" x2="12" y2="13"></line>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
            <div class="text-start">
              <strong>What happened?</strong><br />
              <small
                >The server encountered an error while processing your request.
                This could be due to high traffic, maintenance, or a temporary
                technical issue.</small
              >
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="error-actions mb-5">
          <div class="row g-3 justify-content-center">
            <div class="col-auto">
              <button
                onclick="location.reload()"
                class="btn btn-primary btn-lg"
              >
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  class="me-2"
                >
                  <polyline points="23 4 23 10 17 10"></polyline>
                  <polyline points="1 20 1 14 7 14"></polyline>
                  <path
                    d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4-4.64 4.36A9 9 0 0 1 3.51 15"
                  ></path>
                </svg>
                Try Again
              </button>
            </div>
            <div class="col-auto">
              <a
                href="{{ url_for('index') }}"
                class="btn btn-outline-primary btn-lg"
              >
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  class="me-2"
                >
                  <path
                    d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
                  ></path>
                  <polyline points="9,22 9,12 15,12 15,22"></polyline>
                </svg>
                Go Home
              </a>
            </div>
            <div class="col-auto">
              <button onclick="history.back()" class="btn btn-secondary btn-lg">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  class="me-2"
                >
                  <path d="m12 19-7-7 7-7"></path>
                  <path d="M19 12H5"></path>
                </svg>
                Go Back
              </button>
            </div>
          </div>
        </div>

        <!-- Troubleshooting Steps -->
        <div class="troubleshooting-steps">
          <div class="card shadow-sm">
            <div class="card-header bg-light">
              <h5 class="mb-0 text-secondary">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  class="me-2"
                >
                  <circle cx="12" cy="12" r="3"></circle>
                  <path
                    d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"
                  ></path>
                </svg>
                What you can try:
              </h5>
            </div>
            <div class="card-body">
              <div class="row g-4">
                <div class="col-md-6">
                  <div class="d-flex">
                    <div class="flex-shrink-0 me-3">
                      <div class="step-number">1</div>
                    </div>
                    <div>
                      <h6 class="mb-1">Refresh the Page</h6>
                      <small class="text-muted"
                        >Try reloading the page after a few seconds. The issue
                        might be temporary.</small
                      >
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="d-flex">
                    <div class="flex-shrink-0 me-3">
                      <div class="step-number">2</div>
                    </div>
                    <div>
                      <h6 class="mb-1">Check Your Connection</h6>
                      <small class="text-muted"
                        >Ensure you have a stable internet connection and try
                        again.</small
                      >
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="d-flex">
                    <div class="flex-shrink-0 me-3">
                      <div class="step-number">3</div>
                    </div>
                    <div>
                      <h6 class="mb-1">Wait a Moment</h6>
                      <small class="text-muted"
                        >If our server is under heavy load, waiting a few
                        minutes might help.</small
                      >
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="d-flex">
                    <div class="flex-shrink-0 me-3">
                      <div class="step-number">4</div>
                    </div>
                    <div>
                      <h6 class="mb-1">Contact Support</h6>
                      <small class="text-muted"
                        >If the problem persists, please let us know about this
                        error.</small
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Error Details (for debugging - only show in development) -->
        {% if config.DEBUG %}
        <div class="error-details mt-4">
          <div class="card bg-dark text-light">
            <div class="card-header">
              <h6 class="mb-0">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  class="me-2"
                >
                  <polygon
                    points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"
                  ></polygon>
                </svg>
                Debug Information
              </h6>
            </div>
            <div class="card-body">
              <small class="font-monospace">
                Error ID: {{ request.environ.get('HTTP_X_REQUEST_ID', 'N/A')
                }}<br />
                Timestamp: {{ moment().format('YYYY-MM-DD HH:mm:ss UTC') if
                moment else 'N/A' }}<br />
                Path: {{ request.path }}<br />
                Method: {{ request.method }}
              </small>
            </div>
          </div>
        </div>
        {% endif %}

        <!-- Footer Message -->
        <div class="error-footer mt-5 pt-4 border-top">
          <p class="text-muted mb-0">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              class="me-2"
            >
              <path d="M9 12l2 2 4-4"></path>
              <path
                d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9c2.39 0 4.56.94 6.16 2.47L12 12"
              ></path>
            </svg>
            We're working hard to resolve this issue. Thank you for your
            patience!
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .error-page {
    padding: 3rem 0;
    min-height: 60vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .error-icon svg {
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
  }

  .error-code {
    font-size: 8rem;
    font-weight: 900;
    background: linear-gradient(135deg, var(--danger-color), #b02a37);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  .step-number {
    width: 24px;
    height: 24px;
    background: linear-gradient(
      135deg,
      var(--primary-color),
      var(--primary-dark)
    );
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
    font-weight: 600;
  }

  .troubleshooting-steps .card {
    border: none;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  }

  .error-details {
    max-width: 600px;
    margin: 0 auto;
  }

  @media (max-width: 768px) {
    .error-code {
      font-size: 6rem;
    }

    .error-actions .btn {
      width: 100%;
      margin-bottom: 0.5rem;
    }

    .troubleshooting-steps .col-md-6 {
      margin-bottom: 1rem;
    }
  }

  /* Auto-refresh animation */
  .btn-primary:hover {
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.05);
    }
    100% {
      transform: scale(1);
    }
  }
</style>

<script>
  // Auto-retry functionality (optional)
  let retryCount = 0;
  const maxRetries = 3;

  function autoRetry() {
    if (retryCount < maxRetries) {
      retryCount++;
      console.log(`Auto-retry attempt ${retryCount}/${maxRetries}`);
      setTimeout(() => {
        location.reload();
      }, 5000 * retryCount); // Exponential backoff
    }
  }

  // Uncomment the line below to enable auto-retry
  // setTimeout(autoRetry, 10000); // Wait 10 seconds before first retry
</script>
{% endblock %}
